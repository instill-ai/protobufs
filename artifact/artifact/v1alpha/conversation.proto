syntax = "proto3";

package artifact.artifact.v1alpha;

// Protocol Buffers Well-Known Types
import "google/protobuf/timestamp.proto";

// Conversation represents a chat conversation
message Conversation {
    // conversation id/name
    string uid = 1;
    // namespace id  
    string namespace_id = 2;
    // catalog id  
    string catalog_id = 3;
    // unique identifier of the conversation created by the system
    string id = 4;
    // creation time of the conversation
    google.protobuf.Timestamp create_time = 5;
    // update time of the conversation  
    google.protobuf.Timestamp update_time = 6;
}

// Message represents a single message in a conversation
message Message {
    // message type 
    enum MessageType {
        // unspecified
        MESSAGE_TYPE_UNSPECIFIED = 0;
        // text
        MESSAGE_TYPE_TEXT = 1;
        }
    // message uid
    string uid = 1;
    // catalog uid
    string catalog_uid = 2;
    // conversation uid
    string conversation_uid = 3;
    // message content
    string content = 4;
    // message role e.g., "user" or "assistant"
    string role = 5;
    // message type 
    MessageType type = 6;
    // creation time of the message
    google.protobuf.Timestamp create_time = 7;
    // update time of the message
    google.protobuf.Timestamp update_time = 8;
}

// CreateConversationRequest is used to create a new conversation
message CreateConversationRequest {
    // namespace id
    string namespace_id = 1 [(google.api.field_behavior) = REQUIRED];
    // catalog id  
    string catalog_id = 2;
    // conversation id. only allow kabab case
    string conversation_id = 3 [(google.api.field_behavior) = REQUIRED];
}

// CreateConversationResponse returns the created conversation
message CreateConversationResponse {
    Conversation conversation = 1;
}

// ListConversationsRequest is used to list conversations
message ListConversationsRequest {
    string namespace_id = 1;
    string catalog_id = 2;
    int32 page_size = 3;
    string page_token = 4;
}

// ListConversationsResponse returns a list of conversations
message ListConversationsResponse {
    repeated Conversation conversations = 1;
    string next_page_token = 2;
}

// UpdateConversationRequest is used to update a conversation
message UpdateConversationRequest {
    string namespace_id = 1;
    string catalog_id = 2;
    string conversation_id = 3;
    string new_conversaion_id = 4;
}

// UpdateConversationResponse returns the updated conversation
message UpdateConversationResponse {
    Conversation conversation = 1;
}

// DeleteConversationRequest is used to delete a conversation
message DeleteConversationRequest {
    string namespace_id = 1;
    string catalog_id = 2;
    string conversation_id = 3;
}

// DeleteConversationResponse is empty as no content needs to be returned
message DeleteConversationResponse {
}

// CreateMessageRequest is used to create a new message
message CreateMessageRequest {
    string namespace_id = 1;
    string catalog_id = 2;
    string conversation_id = 3;
    string content = 4;
    string role = 5;
    Message.MessageType type = 6;
}

// CreateMessageResponse returns the created message
message CreateMessageResponse {
    Message message = 1;
}

// ListMessagesRequest is used to list messages in a conversation
message ListMessagesRequest {
    string namespace_id = 1;
    string catalog_id = 2;
    string conversation_id = 3;
    int32 latest_k = 4;
    int32 page_size = 5;
    string page_token = 6;
    bool include_system_messages = 7;
}

// ListMessagesResponse returns a list of messages
message ListMessagesResponse {
    repeated Message messages = 1;
    string next_page_token = 2;
}

// UpdateMessageRequest is used to update a message
message UpdateMessageRequest {
    string namespace_id = 1;
    string conversation_id = 2;
    string message_uid = 3;
    string content = 4;
}

// UpdateMessageResponse returns the updated message
message UpdateMessageResponse {
    Message message = 1;
}

// DeleteMessageRequest is used to delete a message
message DeleteMessageRequest {
    string namespace_id = 1;
    string conversation_id = 2;
    string message_uid = 3;
}

// DeleteMessageResponse is empty as no content needs to be returned
message DeleteMessageResponse {}